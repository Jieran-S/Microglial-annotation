# Microglial Analysis: Gpnmb KO vs WT

Bulk and scRNA analysis, for Microglia.

---

## Folder structure

-   `R`: All the codes to generate analysis for single cell and bulk-seq analysis. All files starting with `01X` are for single cell analysis. And all the files starting `03X` are files dealing with bulk-seq analysis. Sequential execution of `qmd` files should lead to runnable and reproducible results, although bear in mind the DEGs from Bulk-seq data is required for 013 and 014. Check the `sessionInfo()` for each file in advance for the specific version of packages used (A `requirements.txt` is under construction).

-   `Data` : Some intermediate result files generated by each script. The initial index indicates which code script they're generated from. Only `csv` files are uploaded here.

-   `Visualization` : Some visualization results from the analysis.

-   `Markers` : Files containing marker gene lists used for annotation.

---

## Workflow

![Single_cell_pipeline - Microglial Annotation](https://user-images.githubusercontent.com/91852421/229467316-5538a78e-ff2a-4811-a184-5e90aa13b3db.png)

1.  Import and preprocess the data

2.  Quality control and visualization

3.  Normalization, Scaling and PCA/integration

4.  Clustering and visualization

5.  Annotation

6.  Visualization

## Annotation breakdown

1.  Import all markers and plot the heatmap for overlapping heatmap population distribution (High resolution)

2.  Pseudo-bulk analysis: mean log expression data for each cluster -\> Heatmap again (low resolution)

3.  Summarizing each cell type based on the mean expression value for its corresponding marker genes

4.  Try hirearchical classification on labelling (Heatmap)

5.  Label and visualization again

6.  Subsequent visulization of barplot (in case of larger sample sizes), vlnplot (expression profile), and ridgeplot (similar comparision data)
